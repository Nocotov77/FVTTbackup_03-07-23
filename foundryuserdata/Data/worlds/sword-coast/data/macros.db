{"type":"script","scope":"actor","name":"Голодная пасть","img":"icons/creatures/abilities/mouth-teeth-lamprey-red.webp","command":"dnd5e.documents.macro.rollItem(\"Голодная пасть\")","flags":{"dnd5e":{"itemMacro":true}},"author":"PBwWSMBWAQ0RXx3i","folder":null,"sort":0,"ownership":{"default":0,"PBwWSMBWAQ0RXx3i":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1678989434892,"modifiedTime":1678989434892,"lastModifiedBy":"PBwWSMBWAQ0RXx3i"},"_id":"1oKF2gBzL1pb4pKv"}
{"name":"Портрет токена","type":"script","author":"qaQCG0lQ1MdG3tft","img":"icons/environment/people/commoner.webp","scope":"global","command":"// Макрос для Foundry, который позволяет показать игрокам портрет выделенного токена. \ncanvas.tokens.updateAll(\n  token => ({ displayName : CONST.TOKEN_DISPLAY_MODES.HOVER }),\n  token => token._controlled,\n);\n\nconst popout = new ImagePopout(canvas.tokens.controlled[0].actor.data.img).render(true);\npopout.shareImage();","flags":{"exportSource":{"world":"avernus","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.3"},"core":{"sourceId":"Macro.hLjBBjMSMCjdTMw6"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1672485486112,"modifiedTime":1678632186784,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"folder":"daDXMUXmJuNDQyos","sort":150000,"ownership":{"default":0,"ekSJaSkR4p1sowmM":3,"qaQCG0lQ1MdG3tft":3},"_id":"2ZP5IClybjUYZN8n"}
{"name":"Зрение","type":"script","author":"qaQCG0lQ1MdG3tft","img":"icons/magic/perception/eye-ringed-glow-angry-large-teal.webp","scope":"global","command":"// Макрос для Foundry, который позволяет пользователю настраивать параметры обзора и освещения своего токена. \n\nlet applyChanges = false;\nnew Dialog({\n  title: `Конфигурация зрения токена`,\n  content: `\n    <form>\n      <div class=\"form-group\">\n        <label>Тип зрения:</label>\n        <select id=\"vision-type\" name=\"vision-type\">\n          <option value=\"nochange\">Без изменений</option>\n          <option value=\"dim0\">Зрение</option>\n          <option value=\"dim30\">Ночное зрение (30 футов)</option>\n          <option value=\"dim60\">Ночное зрение (60 футов)</option>\n          <option value=\"dim90\">Ночное зрение (90 футов)</option>\n          <option value=\"dim120\">Ночное зрение (120 футов)</option>\n          <option value=\"dim150\">Ночное зрение (150 футов)</option>\n          <option value=\"dim180\">Ночное зрение (180 футов)</option>\n          <option value=\"bright120\">Дьявольское зрение (Колдун)</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>Источник света:</label>\n        <select id=\"light-source\" name=\"light-source\">\n          <option value=\"nochange\">Без изменений</option>\n          <option value=\"none\">Нет</option>\n          <option value=\"candle\">Свеча</option>\n          <option value=\"lamp\">Лампа</option>\n          <option value=\"bullseye\">Фонарь потайной</option>\n          <option value=\"hooded-dim\">Фонарь (обычный — приглушённый)</option>\n          <option value=\"hooded-bright\">Фонарь (обычный — яркий)</option>\n          <option value=\"light\">Свет (Фокус)</option>\n          <option value=\"torch\">Факел</option>\n          <option value=\"moon-touched\">Осенённое луной оружие</option>\n        </select>\n      </div>\n    </form>\n    `,\n  buttons: {\n    yes: {\n      icon: \"<i class='fas fa-check'></i>\",\n      label: `Применить`,\n      callback: () => applyChanges = true\n    },\n    no: {\n      icon: \"<i class='fas fa-times'></i>\",\n      label: `Отменить`\n    },\n  },\n  default: \"yes\",\n  close: html => {\n    if (applyChanges) {\n      let updates = [];\n      for ( let token of canvas.tokens.controlled ) {\n        let visionType = html.find('[name=\"vision-type\"]')[0].value || \"none\";\n        let lightSource = html.find('[name=\"light-source\"]')[0].value || \"none\";\n        let dimSight = 0;\n        let brightSight = 0;\n        let dimLight = 0;\n        let brightLight = 0;\n        let lightAngle = 360;\n        let lockRotation = token.data.lockRotation;\n        let lightAnimation = token.data.light.animation;\n        let lightAlpha = token.data.light.alpha;\n        let lightColor = token.data.light.color;\n        const colorFire = \"#f8c377\";\n        const colorWhite = \"#ffffff\";\n        const colorMoonGlow = \"#f4f1c9\";\n        // Get Vision Type Values\n        switch (visionType) {\n          case \"dim0\":\n            dimSight = 0;\n            brightSight = 0;\n            break;\n          case \"dim30\":\n            dimSight = 30;\n            brightSight = 0;\n            break;\n          case \"dim60\":\n            dimSight = 60;\n            brightSight = 0;\n            break;\n          case \"dim90\":\n            dimSight = 90;\n            brightSight = 0;\n            break;\n          case \"dim120\":\n            dimSight = 120;\n            brightSight = 0;\n            break;\n          case \"dim150\":\n            dimSight = 150;\n            brightSight = 0;\n            break;\n          case \"dim180\":\n            dimSight = 180;\n            brightSight = 0;\n            break;\n          case \"bright120\":\n            dimSight = 0;\n            brightSight= 120;\n            break;\n          case \"nochange\":\n          default:\n            dimSight = token.data.dimSight;\n            brightSight = token.data.brightSight;\n        }\n        // Get Light Source Values\n        switch (lightSource) {\n          case \"none\":\n            dimLight = 0;\n            brightLight = 0;\n            lightAnimation = {type: \"none\"};\n            break;\n          case \"candle\":\n            dimLight = 10;\n            brightLight = 5;\n            lightAnimation = {type: \"torch\", speed: 2, intensity: 2};\n            lightColor = colorFire;\n            lightAlpha = 0.15;\n            break;\n          case \"lamp\":\n            dimLight = 45;\n            brightLight = 15;\n            lightAnimation = {type: \"torch\", speed: 2, intensity: 2};\n            lightColor = colorFire;\n            lightAlpha = 0.15;\n            break;\n          case \"bullseye\":\n            dimLight = 120;\n            brightLight = 60;\n            lockRotation = false;\n            lightAngle = 52.5;\n            lightAnimation = {type: \"torch\", speed: 2, intensity: 2};\n            lightColor = colorFire;\n            lightAlpha = 0.15;\n            break;\n          case \"hooded-dim\":\n            dimLight = 5;\n            brightLight = 0;\n            lightAnimation = {type: \"torch\", speed: 2, intensity: 2};\n            lightColor = colorFire;\n            lightAlpha = 0.15;\n            break;\n          case \"hooded-bright\":\n            dimLight = 60;\n            brightLight = 30;\n            lightAnimation = {type: \"torch\", speed: 2, intensity: 2};\n            lightColor = colorFire;\n            lightAlpha = 0.15;\n            break;\n          case \"light\":\n            dimLight = 40;\n            brightLight = 20;\n            lightAnimation = {type: \"none\"};\n            lightColor = colorWhite;\n            lightAlpha = 0.15;\n            break;\n          case \"torch\":\n            dimLight = 40;\n            brightLight = 20;\n            lightAnimation = {type: \"torch\", speed: 2, intensity: 2};\n            lightColor = colorFire;\n            lightAlpha = 0.15;\n            break;\n          case \"moon-touched\":\n            dimLight = 30;\n            brightLight = 15;\n            lightAnimation = {type: \"none\"};\n            lightColor = colorMoonGlow;\n            break;\n          case \"nochange\":\n          default:\n            dimLight = token.data.light.dim;\n            brightLight = token.data.light.bright;\n            lightAngle = token.data.light.angle;\n            lockRotation = token.data.lockRotation;\n            lightAnimation = token.data.light.animation;\n            lightAlpha = token.data.light.alpha;\n            lightColor = token.data.light.color;\n        }\n        // Update Token\n        updates.push({\n          _id: token.id,\n          vision: true,\n          dimSight: dimSight,\n          brightSight: brightSight,\n          \"light.dim\": dimLight,\n          \"light.bright\":  brightLight,\n          \"light.angle\": lightAngle,\n          lockRotation: lockRotation,\n          \"light.animation\": lightAnimation,\n          \"light.alpha\": lightAlpha,\n          \"light.color\": lightColor\n        });\n      }\n      canvas.scene.updateEmbeddedDocuments(\"Token\", updates);\n    }\n  }\n}).render(true);","flags":{"scene-packer":{"hash":"5188e6ec28231171e3ec1d1964a7706234303ad1","sourceId":"Macro.6N0B0ZXbO2oeLqX2"},"combat-utility-belt":{"macroTrigger":""},"advanced-macros":{"runAsGM":false},"socketmacros":{"isSocket":false},"exportSource":{"world":"tyrany","system":"dnd5e","coreVersion":"10.290","systemVersion":"2.0.3"},"core":{"sourceId":"Macro.mye13wO0ulyTXJwN"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1667586201333,"modifiedTime":1678632183059,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"folder":"daDXMUXmJuNDQyos","sort":200000,"ownership":{"default":0,"ekSJaSkR4p1sowmM":3,"qaQCG0lQ1MdG3tft":3},"_id":"77aV4zw4qxybumXG"}
{"type":"script","scope":"actor","name":"Укус","img":"icons/creatures/abilities/mouth-teeth-sharp.webp","command":"dnd5e.documents.macro.rollItem(\"Укус\")","flags":{"dnd5e":{"itemMacro":true}},"author":"PBwWSMBWAQ0RXx3i","folder":null,"sort":0,"ownership":{"default":0,"PBwWSMBWAQ0RXx3i":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1678989431002,"modifiedTime":1678989431002,"lastModifiedBy":"PBwWSMBWAQ0RXx3i"},"_id":"8C5vYSoGRdeANoBk"}
{"name":"Картинка в чат или шепот","type":"script","author":"qaQCG0lQ1MdG3tft","img":"https://cdn.iconscout.com/icon/free/png-256/send-mail-69-667875.png","scope":"global","command":"// Макрос для Foundry, который позволяет отправить картинку (из ссылки) определённому игроку или всем игрокам. Причем если в Чат, то картинка будет приватной, а если как Всплывающее изображение, то будет показано всем. \nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay));\nasync function imageMessage(html, mode) {\n    const url = html.find(\"[name=url]\")[0].value;\n    if (url === \"\") {\n        return;\n    }\n    if (mode == \"chat\") {\n        const messageContent = `<img src=\"${url}\" />`;\n        const checked = html.find(\"[name=whisper]\")[0].checked;\n        if(!checked) {\n            await ChatMessage.create({content: messageContent});\n            return;\n        }\n        const playerId = html.find(\"[name=player]\")[0].value;\n        const playerName = game.users.get(playerId).data.name;\n        await ChatMessage.create({content: messageContent, whisper: ChatMessage.getWhisperRecipients(playerName)})\n    }\n    if (mode == \"popout\"){\n        const popout = new ImagePopout(url).render(true);\n        popout.shareImage();\n    }\n\n}\n(async () => {\n    let dialogOptions = game.users.filter(u => u.data.role < 3).map(u => `<option value=${u.id}> ${u.data.name} </option>`).join(``);\n    \n    \n    let dialogContent = `\n                        <div><h2>Вставьте ссылку на изображение:</h2><div>\n                        <div>URL: <input name=\"url\" style=\"width:350px\"/></div>\n                        <div><i>если изображение взято из Интернета, не забудьте включить http(s):// в url</i></div>\n                        <div>Шептать игроку?<input name=\"whisper\" type=\"checkbox\"/></div>\n                        <div\">Имя игрока:<select name=\"player\" disabled>${dialogOptions}</select></div>\n                        `;\n    let d = new Dialog({\n        title: \"Image to Chat\",\n        content: dialogContent,\n        buttons: {\n            done: {\n                label: \"Отправить в чат!\",\n                callback: (html) => {\n                    imageMessage(html, \"chat\");\n                }\n            },\n            show: {\n                label: \"Показать как всплывающее изображение!\",\n                callback: (html) => {\n                    imageMessage(html, \"popout\");\n                }\n            }\n        },\n        default: \"done\"    \n    })\n    d.render(true)\n    await wait(50)\n    $(document).ready(function() {\n        $(\"[name=whisper]\").change(function () {\n            if($(\"[name=player]\").attr(\"disabled\")){\n                $(\"[name=player]\").removeAttr(\"disabled\")\n            }\n            else {\n               $(\"[name=player]\").attr(\"disabled\", true)  \n            }\n        });\n    });\n})();","flags":{"advanced-macros":{"runAsGM":false},"exportSource":{"world":"cm1_jes","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.3"},"core":{"sourceId":"Macro.fSyGEAXUVN12sTo1"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1672486740754,"modifiedTime":1678632141612,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"folder":"9Lzn9MKcCDRSQm5X","sort":103125,"ownership":{"default":2,"ekSJaSkR4p1sowmM":3,"qaQCG0lQ1MdG3tft":3},"_id":"B0ptq9YlqFwr6hDw"}
{"name":"Save Blood to Tile","type":"script","author":"qaQCG0lQ1MdG3tft","img":"icons/magic/unholy/projectiles-binary-pink.webp","scope":"global","command":"BloodSplatter.saveBlood()","folder":"S2la5I5iwvgo5dmV","sort":200000,"flags":{"advanced-macros":{"runAsGM":true},"core":{"sourceId":"Macro.GTs0Ymx7CtwtTsL1"}},"ownership":{"default":0,"Cspu3pxFr7tu7SU7":3,"qaQCG0lQ1MdG3tft":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1679168768476,"modifiedTime":1679168790739,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"_id":"EV9SppBLMGGbLBdT"}
{"name":"New Macro","type":"chat","scope":"global","author":"opVdFn7kdsLesJa9","img":"icons/svg/dice-target.svg","command":"","folder":null,"sort":0,"ownership":{"default":0,"opVdFn7kdsLesJa9":3},"flags":{},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1680803537079,"modifiedTime":1680803537079,"lastModifiedBy":"opVdFn7kdsLesJa9"},"_id":"Eob2jpBH670o0WRo"}
{"name":"New Macro","type":"chat","scope":"global","author":"opVdFn7kdsLesJa9","img":"icons/svg/dice-target.svg","command":"","folder":null,"sort":0,"ownership":{"default":0,"opVdFn7kdsLesJa9":3},"flags":{},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1680013963585,"modifiedTime":1680013963585,"lastModifiedBy":"opVdFn7kdsLesJa9"},"_id":"FQgWdJAbw7HX8cgP"}
{"name":"Иницитива для всех","type":"script","author":"qaQCG0lQ1MdG3tft","img":"icons/svg/d20-highlight.svg","scope":"global","command":"/**\n * Берет все выбранные токены и добавляет их в боевой трекер. Затем бросает инициативу для всех токенов NPC и игроков.\n */\nasync function main() {\n await canvas.tokens.toggleCombat();\n  game.combat.rollNPC({ messageOptions: { rollMode: CONST.DICE_ROLL_MODES.PRIVATE }})\ngame.combat.rollAll()\n}\nmain();","flags":{"exportSource":{"world":"avernus","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.3"},"core":{"sourceId":"Macro.fSyGEAXUVN12sTo1"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1672486312944,"modifiedTime":1678632181559,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"folder":"daDXMUXmJuNDQyos","sort":100000,"ownership":{"default":0,"ekSJaSkR4p1sowmM":3,"qaQCG0lQ1MdG3tft":3},"_id":"H6ctdvWkIGsXISFK"}
{"name":"Заявка","type":"script","scope":"global","author":"qaQCG0lQ1MdG3tft","img":"icons/skills/social/wave-halt-stop.webp","command":"// Макрос для Foundry, который позволяет пользователю вывести в чат сообщение о заявке. Спасибо Elfrey и Salamander\n// Макрос для Foundry, который позволяет пользователю вывести в чат сообщение о заявке. Спасибо Elfrey и Salamander\nAudioHelper.play({src: 'https://raw.githubusercontent.com/laaruk/journal/main/bell.ogg', volume: 1, autoplay: true, loop: false}, true);\n\nconst text = '<h1 style=\"text-align: center;\"><span style=\"font-size:36px;\"><span style=\"color:#8000ff;\">Заявка</strong></h1><img src=\"icons/skills/social/wave-halt-stop.webp\" width=\"350\">'\n\nChatMessage.create({\nuser: game.user._id,\nspeaker: ChatMessage.getSpeaker({token: actor}),\ncontent: text\n});","flags":{"core":{"sourceId":"Macro.PtMGtNubVSLEDRL0"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1672482311656,"modifiedTime":1678632141611,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"folder":"9Lzn9MKcCDRSQm5X","sort":200000,"ownership":{"default":2,"ekSJaSkR4p1sowmM":3,"qaQCG0lQ1MdG3tft":3},"_id":"IEP5jqG47cPzfRNo"}
{"name":"Проверка Расследования","type":"script","author":"qaQCG0lQ1MdG3tft","img":"https://i.imgur.com/VibZPwz.png","scope":"global","command":"//Проверка навыка. \n// Если у игрока несколько персонажей, необходимо выделить тот токен, за которого будет бросаться проверка.\nactor.rollSkill('inv');","flags":{"advanced-macros":{"runAsGM":false},"exportSource":{"world":"avernus","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.3"},"core":{"sourceId":"Macro.fSyGEAXUVN12sTo1"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1672486924439,"modifiedTime":1678632141612,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"folder":"9Lzn9MKcCDRSQm5X","sort":100391,"ownership":{"default":2,"ekSJaSkR4p1sowmM":3,"qaQCG0lQ1MdG3tft":3},"_id":"J7m3pHMGBMtvzGEv"}
{"name":"Свет","type":"script","author":"qaQCG0lQ1MdG3tft","img":"icons/sundries/lights/lantern-iron-lit-yellow.webp","scope":"global","command":"// Макрос для Foundry, который позволяет пользователю настраивать параметры освещения своего токена. \nfunction tokenUpdate(data) {\n  canvas.tokens.controlled.map(token => token.document.update({light: data}));\n}\n\nlet torchAnimation = {\"type\": \"torch\", \"speed\": 1, \"intensity\": 1, \"reverse\": false};\n\nlet dialogEditor = new Dialog({\n  title: `Светильник для токена`,\n  content: `Выберите источник света для этого токена.`,\n  buttons: {\n    none: {\n      label: `Отключить`,\n      callback: () => {\n        tokenUpdate({\"dim\": 0, \"bright\": 0, \"angle\": 360, \"luminosity\": 0.5});\n        dialogEditor.render(true);\n      }\n    },\n    torch: {\n      label: `Факел`,\n      callback: () => {\n        tokenUpdate({\"dim\": 40, \"bright\": 20, \"angle\": 360, \"luminosity\": 0.5, \"animation\": torchAnimation});\n        dialogEditor.render(true);\n      }\n    },\n    light: {\n      label: `Фокус Свет`,\n      callback: () => {\n        tokenUpdate({\"dim\": 40, \"bright\": 20, \"angle\": 360, \"luminosity\": 0.5, \"animation\": {\"type\": \"none\"}});\n        dialogEditor.render(true);\n      }\n    },\n    lamp: {\n      label: `Лампа`,\n      callback: () => {\n        tokenUpdate({\"dim\": 45, \"bright\": 15, \"angle\": 360, \"luminosity\": 0.5, \"animation\": torchAnimation});\n        dialogEditor.render(true);\n      }\n    },\n    bullseye: {\n      label: `Потайной фонарь`,\n      callback: () => {\n        tokenUpdate({\"dim\": 120, \"bright\": 60, \"angle\": 45, \"luminosity\": 0.5, \"animation\": torchAnimation});\n        dialogEditor.render(true);\n      }\n    },\n    hoodedOpen: {\n      label: `Обычный фонарь (Открыт)`,\n      callback: () => {\n        tokenUpdate({\"dim\": 60, \"bright\": 30, \"angle\": 360, \"luminosity\": 0.5, \"animation\": torchAnimation});\n        dialogEditor.render(true);\n      }\n    },\n    hoodedClosed: {\n      label: `Обычный фонарь (Приглушен)`,\n      callback: () => {\n        tokenUpdate({\"dim\": 5, \"bright\": 0, \"angle\": 360, \"luminosity\": 0.5, \"animation\": torchAnimation});\n        dialogEditor.render(true);\n      }\n    },\n    darkness: {\n      label: `Заклинание Тьма`,\n      callback: () => {\n        tokenUpdate({\"dim\": 0, \"bright\": 15, \"angle\": 360, \"luminosity\": -0.5, \"animation\": {\"type\": \"none\"}});\n        dialogEditor.render(true);\n      }\n    },\n    \n  },\n  default: \"close\",\n  close: () => {}\n});\n\ndialogEditor.render(true)","flags":{"exportSource":{"world":"novaya-sistema","system":"dnd5e","coreVersion":"9.280","systemVersion":"1.6.3"},"core":{"sourceId":"Macro.zTQcAR35R2r30R50"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1672483553775,"modifiedTime":1678632141611,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"folder":"9Lzn9MKcCDRSQm5X","sort":125000,"ownership":{"default":2,"ekSJaSkR4p1sowmM":3,"qaQCG0lQ1MdG3tft":3},"_id":"L2liIEj4kOJTMcU2"}
{"name":"Конец хода","type":"script","scope":"global","author":"qaQCG0lQ1MdG3tft","img":"icons/skills/melee/weapons-crossed-daggers-orange.webp","command":"/*\nAuthor: willisrocks\nDescription: \n\nЗавершает текущий ход актеров боевым столкновением. Полезно, когда вы не используете свой боевой трекер. и хотите закончить ход с панели быстрого доступа. Если пользователь является гейм-мастером, он всегда будет завершать текущий ход. \nДля игроков это только закончится ход, когда текущий актер в порядке хода принадлежит вам. На основе работы пользователя Reddit serrag97: https://www.reddit.com/r/FoundryVTT/comments/j1b8gs/next_turn_shortcut/\n*/\n\n// check if the user is a GM\nconst isGM = game.user.isGM;\n// check if the user owns the combatant whose turn it is\nconst isOwner = game.combat.combatant.isOwner;\n\nif (isGM || isOwner) {\n  game.combat.nextTurn();\n} else {\n  ui.notifications.info(\"Как игрок вы можете только продвигать свой ход\");\n}","flags":{"core":{"sourceId":"Macro.2hjDVnk5dbuCSuH6"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1672482529405,"modifiedTime":1678632141611,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"folder":"9Lzn9MKcCDRSQm5X","sort":150000,"ownership":{"default":2,"ekSJaSkR4p1sowmM":3,"qaQCG0lQ1MdG3tft":3},"_id":"LDavx8pdTRjxoy4w"}
{"type":"script","scope":"actor","name":"Ночное зрение","img":"icons/magic/perception/eye-ringed-glow-angry-large-teal.webp","command":"dnd5e.documents.macro.toggleEffect(\"Ночное зрение\")","flags":{"dnd5e":{"effectMacro":true}},"author":"3NAHMw7i4GZu1kon","folder":null,"sort":0,"ownership":{"default":0,"3NAHMw7i4GZu1kon":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1679227308603,"modifiedTime":1679227308603,"lastModifiedBy":"3NAHMw7i4GZu1kon"},"_id":"MnpqfLDn1a7eiPSn"}
{"name":"Удаление выбранных эффектов","type":"script","scope":"global","author":"qaQCG0lQ1MdG3tft","img":"icons/magic/control/buff-luck-fortune-clover-green.webp","command":"// Макрос для Foundry, который позволяет удалить выбранные эффекты с токена. \nconst tokenActor = token?.actor ?? game.user.character;\nconst effects = tokenActor.effects.filter(i => i.isTemporary).reduce((acc, e) => acc += `\n  <div class=\"form-group\">\n    <label for=\"${e.id}\">${e.label}</label>\n    <div class=\"form-fields\"><input type=\"checkbox\" id=\"${e.id}\" /></div>\n  </div><hr>`, ``);\nconst content = `<form>${effects}</form>`;\nconst title = \"Delete effects\";\nconst buttons = {del: {\n  icon: `<i class=\"fas fa-check\"></i>`,\n  label: \"Delete!\",\n  callback: async (html) => {\n    const selected = html[0].querySelectorAll(\"input[type=checkbox]:checked\");\n    const deleteIds = [];\n    for(let s of selected) deleteIds.push(s.id);\n    await tokenActor.deleteEmbeddedDocuments(\"ActiveEffect\", deleteIds);\n  }\n}};\nnew Dialog({content, title, buttons, default: \"del\"}).render(true);","flags":{"core":{"sourceId":"Macro.vnS8BMuJ9OUe7B63"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1672482677160,"modifiedTime":1678632215559,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"folder":"daDXMUXmJuNDQyos","sort":112500,"ownership":{"default":0,"ekSJaSkR4p1sowmM":3,"qaQCG0lQ1MdG3tft":3},"_id":"Q0m5HbE2nT9hFKbe"}
{"type":"script","scope":"actor","name":"Ореол спор","img":"icons/magic/control/silhouette-hold-change-green.webp","command":"dnd5e.documents.macro.rollItem(\"Ореол спор\")","flags":{"dnd5e":{"itemMacro":true}},"author":"PBwWSMBWAQ0RXx3i","folder":null,"sort":0,"ownership":{"default":0,"PBwWSMBWAQ0RXx3i":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1680007057763,"modifiedTime":1680007057763,"lastModifiedBy":"PBwWSMBWAQ0RXx3i"},"_id":"Qz6U4Z1nR9rZIz1h"}
{"name":"Проверка Внимания","type":"script","author":"qaQCG0lQ1MdG3tft","img":"https://i.imgur.com/jOQlpmI.png","scope":"global","command":"//Проверка навыка. \n// Если у игрока несколько персонажей, необходимо выделить тот токен, за которого будет бросаться проверка.\nactor.rollSkill('prc');","flags":{"advanced-macros":{"runAsGM":false},"exportSource":{"world":"avernus","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.3"},"core":{"sourceId":"Macro.fSyGEAXUVN12sTo1"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1672486954303,"modifiedTime":1678632141612,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"folder":"9Lzn9MKcCDRSQm5X","sort":101563,"ownership":{"default":2,"ekSJaSkR4p1sowmM":3,"qaQCG0lQ1MdG3tft":3},"_id":"SvACP9oIKsvZcXCj"}
{"name":"Проверка Проницательности","type":"script","author":"qaQCG0lQ1MdG3tft","img":"https://i.imgur.com/0xfQUUi.png","scope":"global","command":"//Проверка навыка. \n// Если у игрока несколько персонажей, необходимо выделить тот токен, за которого будет бросаться проверка.\nactor.rollSkill('ins');","flags":{"advanced-macros":{"runAsGM":false},"exportSource":{"world":"avernus","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.3"},"core":{"sourceId":"Macro.fSyGEAXUVN12sTo1"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1672486763863,"modifiedTime":1678632141612,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"folder":"9Lzn9MKcCDRSQm5X","sort":100782,"ownership":{"default":2,"ekSJaSkR4p1sowmM":3,"qaQCG0lQ1MdG3tft":3},"_id":"U22Yoc98rdDMvCdn"}
{"name":"Шепот","type":"script","author":"qaQCG0lQ1MdG3tft","img":"https://cdn-icons-png.flaticon.com/512/2755/2755344.png","scope":"global","command":"/** \n * Предоставляет диалог для шепота определенным игрокам. Если у вас выбраны токены, по умолчанию они автоматически попытаются прошептать этим игрокам.\n * @Author: Nelson#3570\n */\n\nlet applyChanges = false;\n\nlet users = game.users.filter(user => user.active);\nlet checkOptions = \"\"\nlet playerTokenIds = users.map(u => u.character?.id).filter(id => id !== undefined);\nlet selectedPlayerIds = canvas.tokens.controlled.map(token => {\n  if (playerTokenIds.includes(token.actor.id)) return token.actor.id;\n});\n\n// Build checkbox list for all active players\nusers.forEach(user => {\n  let checked = !!user.character && selectedPlayerIds.includes(user.character.id) && 'checked';\n  checkOptions+=`\n    <br>\n    <input type=\"checkbox\" name=\"${user.id}\" id=\"${user.id}\" value=\"${user.name}\" ${checked}>\\n\n    <label for=\"${user.id}\">${user.name}</label>\n  `\n});\n\nnew Dialog({\n  title:\"Шёпот\",\n  content:`Шептать: ${checkOptions} <br>\n    <label for=\"message\">Сообщение:</label>\n    <textarea id=\"message\" name=\"message\" rows=\"4\" cols=\"50\"></textarea><br>`,\n  buttons:{\n    whisper:{   \n      label:\"Whisper\",\n      callback: (html) => createMessage(html)\n    }\n  }\n}).render(true);\n\nfunction createMessage(html) {\n  var targets = [];\n  // build list of selected players ids for whispers target\n  for ( let user of users ) {\n    if (html.find('[name=\"'+user.id+'\"]')[0].checked){\n      applyChanges=true;\n      targets.push(user.id);\n    }\n    var messageText = html.find('[name=\"message\"]')[0].value\n  }\nif(!applyChanges)return;\n  ChatMessage.create({\n    content: messageText,\n    whisper: targets\n  });\n}","flags":{"advanced-macros":{"runAsGM":false},"exportSource":{"world":"demo-mad-mage","system":"dnd5e","coreVersion":"10.288","systemVersion":"2.0.3"},"core":{"sourceId":"Macro.yri0AA1nqi7s8xMu"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1672485830656,"modifiedTime":1678632141612,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"folder":"9Lzn9MKcCDRSQm5X","sort":112500,"ownership":{"default":2,"ekSJaSkR4p1sowmM":3,"qaQCG0lQ1MdG3tft":3},"_id":"XbCysA4bcQpxFGb3"}
{"type":"script","scope":"actor","name":"Нашествие (Infestation)","img":"modules/RRItemsTranslationTCE/icons/skills/affliction_13.jpg","command":"dnd5e.documents.macro.rollItem(\"Нашествие (Infestation)\")","flags":{"dnd5e":{"itemMacro":true}},"author":"PBwWSMBWAQ0RXx3i","folder":null,"sort":0,"ownership":{"default":0,"PBwWSMBWAQ0RXx3i":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1678989467310,"modifiedTime":1678989467310,"lastModifiedBy":"PBwWSMBWAQ0RXx3i"},"_id":"a0kqCGIZc1j4x54I"}
{"type":"script","scope":"actor","name":"Ледяное прикосновение / Chill Touch","img":"icons/magic/lightning/claws-unarmed-strike-teal.webp","command":"dnd5e.documents.macro.rollItem(\"Ледяное прикосновение / Chill Touch\")","flags":{"dnd5e":{"itemMacro":true}},"author":"PBwWSMBWAQ0RXx3i","folder":null,"sort":0,"ownership":{"default":0,"PBwWSMBWAQ0RXx3i":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1679238179315,"modifiedTime":1679238179315,"lastModifiedBy":"PBwWSMBWAQ0RXx3i"},"_id":"aNV8C6OHMVaVyjas"}
{"name":"Set custom BloodSheet","type":"script","author":"qaQCG0lQ1MdG3tft","img":"icons/tools/hand/brush-paint-pink.webp","scope":"global","command":"const BloodSheetData = {\n  aberration: \"#b527d5d5\",\n  beast: \"#a51414d8\",\n  celestial: \"#55a6cdd5\",\n  construct: \"#5f4d39d5\",\n  dragon: \"#6a0e0ed8\",\n  elemental: \"#737373b1\",\n  fey: \"#afea44d8\",\n  fiend: \"#b71e46d8\",\n  giant: \"#541e1ed8\",\n  humanoid: \"#a51414d8\",\n  monstrosity: \"#810808d8\",\n  ooze: \"#f3900fd8\",\n  plant: \"#195d09d8\",\n  undead: \"#440707d8\",\n};\n\ngame.settings.set(\"splatter\", \"BloodSheetData\", BloodSheetData);","folder":"S2la5I5iwvgo5dmV","sort":125000,"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.NTw7izfO3KH3JDkd"}},"ownership":{"default":0,"Cspu3pxFr7tu7SU7":3,"qaQCG0lQ1MdG3tft":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1679168773304,"modifiedTime":1679168792798,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"_id":"axWCSVtW7euirTIg"}
{"name":"Торговец редкостей","type":"script","author":"qaQCG0lQ1MdG3tft","img":"icons/sundries/flags/banner-symbol-eye-purple.webp","scope":"global","command":"let applyChanges = false;\nconst tableCompendium = 'laaru-dnd5-hw.tables-extra';\nconst itemsCompendium = 'laaru-dnd5-hw.items';\nconst tableIds = {\n    'common': 'qPouW0h2zXtFo62a',\n    'uncommon': '6wcTUmhT2Hny9vNf',\n    'rare': 'WNZghiAhzqWMqkB4',\n    'veryrare': '587UR1kqHq9vw0gf',\n    'legenrady': 'jHMMeaB95As4WxLu',\n    'artifact': 'Smv2hyvMQh02YOrg',\n}\nconst priceByType = {\n    'common': '(1d6) * 10',\n    'uncommon': '(1d6+1) * 100',\n    'rare': '2d10 * 1000',\n    'veryrare': '(1d4+1) * 10000',\n    'legenrady': '2d6 * 25000',\n    'artifact': '2d6 * 250000',\n}\n\nconst textHeader = `\n<div class=\"table-draw\" data-table-id=\"LMrqEBBn3L1eegpc\">\n<ol class=\"table-results\">\n`;\nconst textFooter = `\n</ol>\n</div>\n`;\nconst itemTextHtml = ({ text, price, img, documentId, documentCollection }) => {\n    return `\n      <li class=\"table-result flexrow\" data-result-id=\"${documentId}}\" style=\"border-top: 1px solid var(--color-border-dark-tertiary); border-bottom: 0; position: relative; width: 100%; padding: 10px 0 0 0;\"\">\n        <img class=\"result-image\" src=\"${img}\">\n        <div class=\"result-text\" style=\"max-width: calc(100% - 44px)\">\n            <a\n                class=\"content-link\"\n                draggable=\"true\" style=\"max-width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: inline-block;\"\n                data-pack=\"${documentCollection}}\"\n                data-uuid=\"Compendium.${documentCollection}.${documentId}\"\n                data-id=\"${documentId}\">\n                    <i class=\"fas fa-suitcase\"></i>${text}\n            </a>\n        </div>\n      </li>\n      <li style=\"padding: 0 0 4px 0;\">\n        <div class=\"flavor-text\" style=\"padding-left: 40px;\"> за <strong>${price}</strong></div>\n      </li>\n`;\n}\n\nnew Dialog({\n    title: `Генератор торговца`,\n    content: `\n    <form>\n      <div class=\"form-group\">\n        <label for=\"count\">Количество предметов(число и формула броска):</label>\n        <input type=\"text\" id=\"shop-gen-count\" name=\"shop-gen-count\" value=\"1d6\" />   \n      </div>\n      <div class=\"form-group\">\n        <label>Редкость предмета:</label>\n        <select id=\"shop-gen-item-rarity\" name=\"shop-gen-item-rarity\">\n          <option value=\"common\">Обычный</option>\n          <option value=\"uncommon\">Необычный</option>\n          <option value=\"rare\">Редкий</option>\n          <option value=\"veryrare\">Крайне редкий</option>\n          <option value=\"legenrady\">Легендарный</option>\n          <option value=\"artifact\">Артефакт</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>Шепот себе:</label>\n        <input type=\"checkbox\" id=\"shop-gen-whisper\" name=\"shop-gen-whisper\" checked >\n      </div>\n    </form>\n    `,\n    buttons: {\n        yes: {\n            icon: \"<i class='fas fa-check'></i>\",\n            label: `Сгенерировать`,\n            callback: () => applyChanges = true\n        },\n        no: {\n            icon: \"<i class='fas fa-times'></i>\",\n            label: `Отмена`\n        },\n    },\n    default: \"yes\",\n    close: async html => {\n        let priceDice = '';\n        let rollTable = null;\n        let rollPrice = null;\n        let textAr = [];\n\n        if (applyChanges) {\n\n            const tablePack = game.packs.get(tableCompendium);\n            if (!tablePack.index.length) await tablePack.getIndex();\n\n            const count = html.find('[name=\"shop-gen-count\"]')[0].value || '1';\n            const type = html.find('[name=\"shop-gen-item-rarity\"]')[0].value || \"common\";\n            const whisper = html.find('[name=\"shop-gen-whisper\"]')[0].checked || false;\n            priceDice = priceByType[type];\n            rollTable = new Roll(count.toString());\n\n            await rollTable.evaluate();\n            let table = await tablePack.getDocument(tableIds[type]);\n\n            let draw = await table.drawMany(rollTable.total, { displayChat: false });\n            textAr = draw.results.map((item) => {\n                rollPrice = new Roll(priceDice);\n                let price = rollPrice.evaluate({async: false});\n\n                return itemTextHtml({\n                    ...item,\n                    price: `${price.total} ЗМ`\n                });\n\n\n            }).join('');\n\n            let chatData = {\n                user: game.user._id,\n                speaker: ChatMessage.getSpeaker(),\n                content: textHeader + textAr + textFooter,\n            };\n            if (whisper) {\n                chatData.whisper = ChatMessage.getWhisperRecipients(\"GM\");\n            }\n              ChatMessage.create(chatData, {});\n        }\n    }\n}).render(true);","flags":{"scene-packer":{"hash":"ae031b26bec696850c882d05540f6177e6fd5aaa","sourceId":"Macro.e00zRTa1QkfFgvot"},"combat-utility-belt":{"macroTrigger":""},"advanced-macros":{"runAsGM":false},"exportSource":{"world":"tyranny-dev","system":"dnd5e","coreVersion":"10.291","systemVersion":"2.0.3"},"core":{"sourceId":"Macro.zTQcAR35R2r30R50"}},"ownership":{"default":0,"ekSJaSkR4p1sowmM":3,"qaQCG0lQ1MdG3tft":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1674748075638,"modifiedTime":1678632216895,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"folder":"daDXMUXmJuNDQyos","sort":106250,"_id":"eUUCJxiVZCMSQsCt"}
{"name":"Clear Blood for all clients","type":"script","author":"qaQCG0lQ1MdG3tft","img":"icons/skills/wounds/injury-stitched-flesh-red.webp","scope":"global","command":"BloodSplatterSocket.executeForEveryone(\"ClearAll\");","folder":"S2la5I5iwvgo5dmV","sort":100000,"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.nM8xo3bDcLYJMJQ7"}},"ownership":{"default":0,"Cspu3pxFr7tu7SU7":3,"qaQCG0lQ1MdG3tft":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1679168765612,"modifiedTime":1679168789608,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"_id":"f6QW7WUFEv27HKER"}
{"name":"Splat Token","type":"script","author":"qaQCG0lQ1MdG3tft","img":"icons/magic/death/skull-weapon-staff-glow-pink.webp","scope":"global","command":"if (!canvas.tokens.controlled[0]) {\n            ui.notifications.warn(\n              game.i18n.localize(\"splatter.controls.splatToken.warn\")\n            );\n          } else {\n            BloodSplatter.socketSplat(canvas.tokens.controlled);\n          }","folder":"S2la5I5iwvgo5dmV","sort":150000,"flags":{"advanced-macros":{"runAsGM":false},"core":{"sourceId":"Macro.6wMaAHw0mY06Jc54"}},"ownership":{"default":0,"Cspu3pxFr7tu7SU7":3,"qaQCG0lQ1MdG3tft":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1679168771586,"modifiedTime":1679168791735,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"_id":"fJtTZhPEcPIFEd0E"}
{"name":"Случайные броски характеристик","type":"script","author":"qaQCG0lQ1MdG3tft","img":"icons/sundries/gaming/dice-pair-white-green.webp","scope":"global","command":"/**\n * Генерирует характеристики персонажа и выводит результат в виде таблицы.\n * Author: @Kekilla#7036 & KrishMero1792\n */\n \n// Formula for rolling \nconst statString = '4d6kh3';\n\n// times to roll those stats\nconst numRolls = 6;\n\n\n//////////////////////////////////////////\n// Don't touch anything below this line //\n//////////////////////////////////////////\nconst stats = Array(numRolls).fill(0).map(e=>new Roll(statString).evaluate({async: false}));\n\nconst rollData = stats[0].dice[0];\nconst {faces, values: keptRolls, results: rolls} = rollData;\nconst totalAverage = (faces/2 + 1) * keptRolls.length;\nconst totalDeviation = faces/2;\nconst totalLow = Math.ceil(totalAverage - totalDeviation);\nconst totalHigh = Math.ceil(totalAverage + totalDeviation);\n\nconst header = rolls.map((roll, index) => `<th>D${index + 1}</th>`).join('');\n\nlet tableRows = '';\nlet finalSum = 0;\nfor(let {terms, total} of stats) {\n  tableRows += `<tr style=\"text-align:center\">`;\n  tableRows += terms[0].results.map(({result, discarded}) => `<td style=\"${colorSetter(result, 1, faces, discarded)}\">${result}</td>`).join('');\n  tableRows += `<td style=\"border-left:1px solid #000; ${colorSetter(total, totalLow, totalHigh)}\">${total}</td></tr>`;\n  finalSum += total;\n}\n\nconst colspan = `colspan=\"${rolls.length + 1}\"`;\nconst center = `text-align:center;`;\n\nlet content = `\n  <table>\n    <tr>\n      <td ${colspan}><h2 style=\"margin-bottom:0; ${center}\">Значения характеристик</h2>\n      <div style=\"margin-bottom: 0.5rem; ${center}\">${statString} были проброшены ${numRolls} раз.</div></td>\n    </tr>\n    <tr style=\"${center} border-bottom:1px solid #000\">\n      ${header}\n      <th style=\"border-left:1px solid #000\">Итог</th>\n    </tr>\n    ${tableRows}\n    <tr style=\"border-top: 1px solid #000\">\n      <th colspan=\"${rolls.length}\" style=\"${center}\">Финальная сумма:</th>\n      <th style=\"${center}\">${finalSum}</th>\n    </tr>\n  </table>\n`;\n\n\nChatMessage.create({content});\n\nfunction colorSetter(number,low,high, discarded)\n{\n  if(discarded === true) return 'text-decoration:line-through;color:gray';\n  if(number <= low) return 'color:red';\n  if(number >= high) return 'color:green';\n  return '';\n}","flags":{"core":{"sourceId":"Compendium.foundry_community_macros.community-macros-roll.cj0Sm0kWnHx11nFR"},"exportSource":{"world":"novaya-sistema","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.3"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1672485699440,"modifiedTime":1678632141611,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"folder":"9Lzn9MKcCDRSQm5X","sort":100000,"ownership":{"default":2,"ekSJaSkR4p1sowmM":3,"qaQCG0lQ1MdG3tft":3},"_id":"g9fqRTUiL7LIUt6P"}
{"name":"Свет","type":"script","author":"MUpd8HxLkIpX9gSf","img":"icons/sundries/lights/lantern-iron-lit-yellow.webp","scope":"global","command":"// Макрос для Foundry, который позволяет пользователю настраивать параметры освещения своего токена. \nfunction tokenUpdate(data) {\n  canvas.tokens.controlled.map(token => token.document.update({light: data}));\n}\n\nlet torchAnimation = {\"type\": \"torch\", \"speed\": 1, \"intensity\": 1, \"reverse\": false};\n\nlet dialogEditor = new Dialog({\n  title: `Светильник для токена`,\n  content: `Выберите источник света для этого токена.`,\n  buttons: {\n    none: {\n      label: `Отключить`,\n      callback: () => {\n        tokenUpdate({\"dim\": 0, \"bright\": 0, \"angle\": 360, \"luminosity\": 0.5});\n        dialogEditor.render(true);\n      }\n    },\n    torch: {\n      label: `Факел`,\n      callback: () => {\n        tokenUpdate({\"dim\": 40, \"bright\": 20, \"angle\": 360, \"luminosity\": 0.5, \"animation\": torchAnimation});\n        dialogEditor.render(true);\n      }\n    },\n    light: {\n      label: `Фокус Свет`,\n      callback: () => {\n        tokenUpdate({\"dim\": 40, \"bright\": 20, \"angle\": 360, \"luminosity\": 0.5, \"animation\": {\"type\": \"none\"}});\n        dialogEditor.render(true);\n      }\n    },\n    lamp: {\n      label: `Лампа`,\n      callback: () => {\n        tokenUpdate({\"dim\": 45, \"bright\": 15, \"angle\": 360, \"luminosity\": 0.5, \"animation\": torchAnimation});\n        dialogEditor.render(true);\n      }\n    },\n    bullseye: {\n      label: `Потайной фонарь`,\n      callback: () => {\n        tokenUpdate({\"dim\": 120, \"bright\": 60, \"angle\": 45, \"luminosity\": 0.5, \"animation\": torchAnimation});\n        dialogEditor.render(true);\n      }\n    },\n    hoodedOpen: {\n      label: `Обычный фонарь (Открыт)`,\n      callback: () => {\n        tokenUpdate({\"dim\": 60, \"bright\": 30, \"angle\": 360, \"luminosity\": 0.5, \"animation\": torchAnimation});\n        dialogEditor.render(true);\n      }\n    },\n    hoodedClosed: {\n      label: `Обычный фонарь (Приглушен)`,\n      callback: () => {\n        tokenUpdate({\"dim\": 5, \"bright\": 0, \"angle\": 360, \"luminosity\": 0.5, \"animation\": torchAnimation});\n        dialogEditor.render(true);\n      }\n    },\n    darkness: {\n      label: `Заклинание Тьма`,\n      callback: () => {\n        tokenUpdate({\"dim\": 0, \"bright\": 15, \"angle\": 360, \"luminosity\": -0.5, \"animation\": {\"type\": \"none\"}});\n        dialogEditor.render(true);\n      }\n    },\n    \n  },\n  default: \"close\",\n  close: () => {}\n});\n\ndialogEditor.render(true)","flags":{"exportSource":{"world":"novaya-sistema","system":"dnd5e","coreVersion":"9.280","systemVersion":"1.6.3"},"core":{"sourceId":"Macro.zTQcAR35R2r30R50"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1672483553775,"modifiedTime":1683229842035,"lastModifiedBy":"MUpd8HxLkIpX9gSf"},"folder":null,"sort":0,"ownership":{"default":0,"ekSJaSkR4p1sowmM":3,"MUpd8HxLkIpX9gSf":3},"_id":"h9pJFp8tqLha3Erq"}
{"name":"New Macro","type":"chat","scope":"global","author":"qaQCG0lQ1MdG3tft","img":"icons/svg/dice-target.svg","command":"","folder":null,"sort":0,"ownership":{"default":0,"qaQCG0lQ1MdG3tft":3},"flags":{},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1682010868474,"modifiedTime":1682010868474,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"_id":"nembzjcw4djZsOTX"}
{"name":"Удалить все шаблоны","type":"script","author":"qaQCG0lQ1MdG3tft","img":"icons/magic/fire/barrier-wall-flame-ring-yellow.webp","scope":"global","command":"// Макрос для Foundry, который позволяет удалить все шаблоны (например от заклинаний) на сцене. \nlet templates = canvas.templates.placeables.map(i=> i.id);\nawait canvas.scene.deleteEmbeddedDocuments(\"MeasuredTemplate\", templates);","flags":{"core":{"sourceId":"Compendium.foundry_community_macros.community-macros-misc.cbvoXlwrSGOFFybV"},"exportSource":{"world":"avernus","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.3"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1672485470192,"modifiedTime":1678632214519,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"folder":"daDXMUXmJuNDQyos","sort":125000,"ownership":{"default":0,"ekSJaSkR4p1sowmM":3,"qaQCG0lQ1MdG3tft":3},"_id":"pfAgq0WK7vdnLP0q"}
{"type":"script","scope":"actor","name":"Деревянный посох","img":"icons/weapons/staves/staff-simple-spiral-green.webp","command":"dnd5e.documents.macro.rollItem(\"Деревянный посох\")","flags":{"dnd5e":{"itemMacro":true}},"author":"PBwWSMBWAQ0RXx3i","folder":null,"sort":0,"ownership":{"default":0,"PBwWSMBWAQ0RXx3i":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1679215870566,"modifiedTime":1679215870566,"lastModifiedBy":"PBwWSMBWAQ0RXx3i"},"_id":"si7MeKxYITy5H5Re"}
{"name":"New Macro","type":"chat","scope":"global","author":"qaQCG0lQ1MdG3tft","img":"icons/svg/dice-target.svg","command":"","folder":null,"sort":0,"ownership":{"default":0,"qaQCG0lQ1MdG3tft":3},"flags":{},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1683223919965,"modifiedTime":1683223919965,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"_id":"u4mgPuOpNwzFNmzb"}
{"name":"New Macro","type":"chat","scope":"global","author":"opVdFn7kdsLesJa9","img":"icons/svg/dice-target.svg","command":"","folder":null,"sort":0,"ownership":{"default":0,"opVdFn7kdsLesJa9":3},"flags":{},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1680802566274,"modifiedTime":1680802566274,"lastModifiedBy":"opVdFn7kdsLesJa9"},"_id":"uR06qJzmxOENKvSJ"}
{"name":"New Macro","type":"chat","scope":"global","author":"MUpd8HxLkIpX9gSf","img":"icons/svg/dice-target.svg","command":"","folder":null,"sort":0,"ownership":{"default":0,"MUpd8HxLkIpX9gSf":3},"flags":{},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1683229745661,"modifiedTime":1683229745661,"lastModifiedBy":"MUpd8HxLkIpX9gSf"},"_id":"vNWa2mxdfR5AB3SO"}
{"name":"Справочник","type":"script","author":"qaQCG0lQ1MdG3tft","img":"modules/laaru-dnd5-hw/assets/icons/feat/phb-skilled.webp","scope":"global","command":"// Макрос для Foundry, который позволяет пользователю открыть справочник Phenomen'a. \nnew Dialog({\n title: \"Справочник\",\n content: `<iframe id=\"jsdos\" src=\"https://5e.ruleplaying.com/\" width=\"100%\" height=\"100%\"></iframe>`,\n buttons: {},\n render: html => {\n        html.style.flex = \"100%\";\n        html.querySelector(\"#jsdos\").focus();\n     }\n}, { height: 600, width: 800, jQuery: false }).render(true);","flags":{"exportSource":{"world":"avernus","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.3"},"core":{"sourceId":"Macro.ufppKNOT0u4ygCXI"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1672483532195,"modifiedTime":1678632141612,"lastModifiedBy":"qaQCG0lQ1MdG3tft"},"folder":"9Lzn9MKcCDRSQm5X","sort":106250,"ownership":{"default":2,"ekSJaSkR4p1sowmM":3,"qaQCG0lQ1MdG3tft":3},"_id":"vjMtLKHozzAPOYwt"}
